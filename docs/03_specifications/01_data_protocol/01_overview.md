> 文档版本：v1.0  
> 负责人：Manus AI  
> 最后更新：2026-02-06  
> 状态：draft

# 1. 数据协议概述

## 1.1 协议目的

本数据协议定义了 AutoPPT Agent 系统内部用于数据交换的**中间层表示（Intermediate Representation, IR）**。这是一个标准化的 JSON 结构，作为系统不同模块之间通信的通用语言，确保了数据的一致性、可靠性和模块间的解耦。

## 1.2 协议角色

- **生产者（Producers）**: 主要由 **Agent Core** 中的智能体（如 `Text Master Agent`, `Design Agent`, `Build Agent`）负责生成。它们将研究结果、内容规划和设计决策转化为符合本协议的结构化 JSON 数据。

- **消费者（Consumers）**: 主要包括 **PPT 渲染引擎（Rendering Engine）** 和 **Web 预览界面（Web Preview UI）**。它们负责解析此 JSON 数据，并将其最终渲染为用户可见的 `.pptx` 文件或网页预览。

## 1.3 设计原则

- **清晰性与可读性**: 协议的字段命名应清晰、直观，易于人类开发者理解和调试。
- **严格性与灵活性**: 协议对核心结构（如根对象、页面基础字段）有严格要求，但对具体版式的内容载荷（Payload）提供了一定的灵活性，以适应不同的页面需求。
- **可扩展性**: 协议设计考虑了未来的功能扩展，允许在不破坏向后兼容性的前提下增加新的页面版式或元数据字段。

## 1.4 协议结构

整个数据协议主要由以下几个部分组成，每个部分都在后续章节中有详细定义：

1.  **根对象结构 (Root Object)**: 定义了整个数据包的顶层结构，包含元数据和页面数组。
2.  **版式枚举 (Layout Enumeration)**: 列出了所有支持的页面版式类型及其语义。
3.  **页面通用结构 (Common Slide Schema)**: 定义了所有页面都必须包含的基础字段。
4.  **版式专用数据 (Layout-Specific Payloads)**: 针对每种版式类型，定义其独特的内容数据结构。
5.  **检索结果协议 (Search Result Protocol)**: 定义了并行搜索阶段的标准输出格式。

遵循此协议是确保系统各模块能够正确协同工作的关键。
