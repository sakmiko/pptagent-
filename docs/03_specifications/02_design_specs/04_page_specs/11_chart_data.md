> 文档版本：v1.0  
> 负责人：Manus AI  
> 最后更新：2026-02-06  
> 状态：stable

# `chart_data` 设计规范

## 1. 用途

`chart_data` 版式专门用于展示包含具体统计数据的图表，如柱状图、折线图、饼图等。它旨在将枯燥的数据转化为直观的视觉信息，帮助观众快速理解数据背后的趋势、对比或构成。

## 2. 数据协议

### 必需字段

- `title`: 页面的主标题，通常用于说明图表的主题。
- `chart_config`: 一个描述图表配置和数据的对象。

### 结构定义

`chart_config` 对象必须包含以下字段：

```typescript
interface ChartConfig {
  type: string;           // 图表类型，如 "bar", "line", "pie"
  data: ChartDataItem[];  // 图表的数据系列
  x_axis_label?: string;  // (可选) X轴的标签说明
  y_axis_label?: string;  // (可选) Y轴的标签说明
}

interface ChartDataItem {
  label: string;  // 数据点的标签，如年份、产品类别
  value: number;  // 数据点的值
}
```

### 可选字段

- `chart_caption`: 图表的补充说明或数据来源。

### 示例

```json
{
  "page_id": 11,
  "layout_type": "chart_data",
  "title": "年度销售额增长趋势 (百万美元)",
  "chart_config": {
    "type": "bar",
    "data": [
      { "label": "2022", "value": 15 },
      { "label": "2023", "value": 28 },
      { "label": "2024", "value": 45 }
    ],
    "x_axis_label": "年份",
    "y_axis_label": "销售额"
  },
  "chart_caption": "数据来源：公司年度财报"
}
```

## 3. 母版与占位符

- **母版 Layout 名称**: `Chart`
- **建议母版索引**: `11`
- **必需占位符**:
  - `title`: 用于页面主标题。
  - `chart`: 一个图表占位符，渲染引擎将在此处创建并填充图表对象。
  - `caption`: (可选) 用于 `chart_caption` 的文本框。

## 4. 设计与排版规则

- **图表类型选择**: 设计 Agent 必须根据数据的性质选择最合适的图表类型：
  - **柱状图 (`bar`)**: 用于比较不同类别的数据。
  - **折线图 (`line`)**: 用于显示数据随时间变化的趋势。
  - **饼图 (`pie`)**: 用于展示整体的构成比例（建议类别不超过5个）。
- **数据清晰**: 图表应清晰易读，避免数据标签重叠。对于复杂的图表，应考虑简化数据或拆分为多个图表。
- **配色**: 图表的颜色应遵循全局的 `theme_palette`。对于多系列图表，应使用主色的同色系色阶变体。
- **原生对象**: 渲染引擎**必须**使用 `python-pptx` 的图表功能创建原生的、可编辑的图表对象，**严禁**将图表渲染为静态图片后插入。

## 5. 禁用项

- **禁止使用图片代替图表**: 严禁将外部生成的图表图片直接插入页面，这会破坏可编辑性。
- **禁止过度设计**: 避免使用3D效果、阴影或过多的装饰，保持图表的简洁和专业。

## 6. 验收清单

- [ ] `chart_config` 对象及其 `type` 和 `data` 字段内容完整。
- [ ] 图表类型与数据内容相匹配。
- [ ] 最终生成的 `.pptx` 文件中，图表是一个原生图表对象，其数据、颜色和标签均可被用户在PowerPoint中直接编辑。
