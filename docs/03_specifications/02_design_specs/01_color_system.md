> 文档版本：v1.0  
> 负责人：Manus AI  
> 最后更新：2026-02-06  
> 状态：draft

# 2. 配色系统规范

配色是决定演示文稿整体风格和专业度的关键因素。AutoPPT Agent 的配色系统旨在实现动态、智能且具有高级感的色彩搭配，而非简单地套用固定模板。

## 2.1 配色生成流程（强制）

设计 Agent (Design Agent) 在确定配色时，必须遵循以下流程：

1.  **语义提取**: 首先，Agent 需要深入分析 `research_summary.md` 的内容，提取与主题相关的行业语义。例如，一篇关于金融科技的报告应偏向蓝色和金色，而一篇关于环保的报告则可能使用绿色和棕色。

2.  **偏好融合**: 其次，Agent 需要融合用户在初始输入中可能提供的风格偏好，如“商务蓝”、“深色科技感”或“极简白”。

3.  **候选生成**: 基于语义和偏好，Agent 应生成至少两套完整的高级配色方案（A/B方案）作为候选。

4.  **智能评估**: 系统将根据色彩理论，从可读性（例如，文本与背景的对比度）、和谐度（色彩搭配是否协调）和情感匹配度（色彩是否符合主题语义）三个维度对候选方案进行打分。

5.  **最终选择**: 选择得分最高的配色方案，并将其完整的色板对象写入 `PresentationPackage` 的 `meta.theme_palette` 字段中。

## 2.2 色板结构 (`ThemePalette`)

每一套最终确定的配色方案都必须包含一个结构完整的 `ThemePalette` 对象，其中定义了12个标准色彩角色。渲染引擎和Web预览界面将严格按照此色板进行渲染。

```json
{
  "theme_palette": {
    "name": "tech_premium_blue",
    "primary": "#1E3A8A",
    "secondary": "#334155",
    "accent": "#22D3EE",
    "bg": "#F8FAFC",
    "surface": "#FFFFFF",
    "text_primary": "#0F172A",
    "text_secondary": "#475569",
    "border": "#CBD5E1",
    "success": "#16A34A",
    "warning": "#D97706",
    "danger": "#DC2626"
  }
}
```

| 角色 | 建议用途 |
| :--- | :--- |
| `primary` | 主色，用于关键元素，如标题、主按钮、图表主色调。 |
| `secondary` | 次要色，用于辅助性元素，提供视觉层次。 |
| `accent` | 强调色，用于需要用户关注的元素，如高亮数据、链接、交互提示。 |
| `bg` | 背景色，页面的主要背景。 |
| `surface` | 表面色，用于卡片、侧边栏等浮于背景之上的元素背景。 |
| `text_primary` | 主要文本颜色，用于标题和正文。 |
| `text_secondary`| 次要文本颜色，用于注释、辅助信息。 |
| `border` | 边框颜色，用于分割线、卡片边框。 |
| `success` | 成功状态色。 |
| `warning` | 警告状态色。 |
| `danger` | 危险/错误状态色。 |

## 2.3 应用原则

- **高级感**: 避免使用大面积、高饱和度的颜色。推荐采用“低饱和度主色 + 小面积高对比度强调色”的搭配策略，营造专业、内敛的视觉感受。
- **一致性**: 在一份演示文稿中，最多只应使用 **1** 个主色系和 **1** 个强调色系。图表中的多系列颜色应为主色的同色系色阶变体（例如，从深蓝到浅蓝）。
- **可访问性**: 正文文本颜色与背景色之间必须保证足够的对比度（遵循WCAG AA标准），确保内容的可读性。同时，不能仅依赖颜色（如红/绿）来传递唯一信息，必须配合图标或标签使用。
- **目的性**: 强调色 (`accent`) 的使用必须克制且有目的，仅用于最需要吸引用户注意力的关键数据点、关键词或交互元素上。
